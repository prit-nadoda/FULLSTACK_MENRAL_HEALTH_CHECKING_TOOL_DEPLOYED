<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>psyCheck | Your Profile</title>
  <link rel="shortcut icon" href="/images/tabLogo.png" type="image/x-icon">
  <!-- font awesome cdn link  -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <!-- swiper css link  -->
  <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />

  <link rel="stylesheet" href="/stylesheets/profile.css">

  <style>
    @import url("https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap");

    :root {
      --primary: #3162d9;
      --light-bg: #f4f4f4;
      --border: #eee;
    }

    * {
      margin: 0;
      padding: 0;
      -webkit-box-sizing: border-box;
      box-sizing: border-box;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
      font-family: 'Poppins', sans-serif;
      -webkit-transition: all 200ms ease-in-out;
      transition: all 200ms ease-in-out;
    }

    body {
      background-color: #b1d8f1;
      min-height: 100vh;


      -webkit-box-pack: center;
      -ms-flex-pack: center;
      justify-content: center;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      color: var(--primary);
    }

    .card {
      margin-top: 100px;
      width: 70%;
      max-width: 1100px;
      background-color: #fff;
      padding: 3rem;
    }

    .card__header {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: -15px;
    }

    .card__profile img {
      border-radius: 50%;
      height: 10rem;
      width: 10rem;
      border: #3162d9 solid 3px;
      -o-object-fit: cover;
      object-fit: cover;
    }

    .card__name {
      font-size: 1.5rem;
      margin-left: 1.25rem;
    }

    .card__handle {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 3px;
    }

    .card__button svg {
      height: 1.05rem;
      width: 1.05rem;
      margin-right: 5px;
    }

    .card__button {
      margin-left: auto;
    }

    .card__button button {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      font-size: 1.05rem;
      background-color: var(--primary);
      color: white;
      font-weight: bold;
      border: none;
      height: 40px;
      width: 100px;
      -webkit-box-pack: center;
      -ms-flex-pack: center;
      justify-content: center;
      cursor: pointer;
    }

    .card__button button:active {
      -webkit-transform: scale(0.96);
      transform: scale(0.96);
    }

    .card__heading {
      font-size: 2rem;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
    }


    .border {
      border-radius: 5px;
      height: 2px;
      background-color: var(--border);
      border: none;
      margin: 1.25rem 0;
    }

    .navlinks {
      list-style: none;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      margin-bottom: 1.25rem;
    }

    .navlinks li {
      opacity: 0.5;
      -webkit-transition: opacity 200ms ease-in-out;
      transition: opacity 200ms ease-in-out;
      cursor: pointer;
    }

    .navlinks li:first-child {
      opacity: 1;
      font-weight: bold;
    }

    .navlinks li:hover {
      opacity: 1;
    }

    .navlinks li+li {
      margin-left: 20px;
    }

    .date {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      font-size: 0.85rem;
    }

    .date svg {
      margin-left: 5px;
      height: 1rem;
      width: 1rem;
    }

    .heading {
      font-weight: bold;
      font-size: 1.5rem;
      justify-content: space-between;
    }

    .insights {
      margin: 2rem 0;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-flex: 1;
      -ms-flex: 1;
      flex: 1;
      -ms-flex-wrap: wrap;
      flex-wrap: wrap;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
    }

    .insights .insight {
      width: 100%;
      padding: 1rem;
      border-radius: 8px;
      outline: 2px solid var(--border);
      -webkit-transition: all 200ms ease-in-out;
      transition: all 200ms ease-in-out;
      margin-bottom: 3rem;
    }

    .insights .insight .delete,
    .heading,
    a {

      -webkit-transition: all 200ms ease-in-out;
      transition: all 200ms ease-in-out;

    }

    .insights .insight:hover {
      color: white;
      background-color: var(--primary);
      outline: none;
    }

    .insights .insight:hover a,
    .insights .insight:hover .heading,
    .insights .insight:hover a {
      color: white;
    }

    .insights .insight .heading {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
    }

    .insights .insight a {
      text-decoration: none;
      color: #3162d9;
    }


    .insights .insight .heading span {
      font-size: 0.8rem;
    }



    .number {
      font-size: 1.5rem;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      font-weight: bold;
      margin-top: 15px;
    }

    .number .info {
      font-size: 1.3rem;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      font-weight: normal;
    }

    .number .info svg {
      height: 15px;
      width: 15px;
    }

    .reports {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-container {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .customAlert {
      background-color: #d1ecf1;
      color: #0c5460;
      padding: 1rem;
      border: 1px solid #bee5eb;
      border-radius: 0.25rem;
      position: relative;
      margin-top: 1rem;
    }

    .alert-message {
      display: block;
      margin-bottom: 0.5rem;
    }

    .close-btn {
      background-color: #0c5460;
      color: #fff;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.25rem;
      cursor: pointer;
      position: absolute;
      top: 50%;
      right: 0.5rem;
      transform: translateY(-50%);
    }

    .close-btn:hover {
      background-color: #07424e;
    }

    .number .date {
      font-size: 1.5rem;
    }



    @media (max-width: 1381px) {
      .insights {
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        justify-content: center;
      }

    }

    @media (max-width: 990px) {
      .insights {
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        justify-content: center;

      }


    }

    @media (max-width: 740px) {
      .card {
        width: 90%;
      }

      .navlinks {
        display: none;
      }
    }

    @media (max-width: 545px) {
      .card__button button {
        width: 40px;
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        justify-content: center;
      }

      .card__button button span {
        display: none;
      }

      .card__button button svg {
        margin-right: 0;
      }
    }

    @media (max-width: 475px) {

      .number .date {
        font-size: 1.3rem;
      }

      .card__name {
        font-size: 1.2rem;
      }

      .card__profile img {
        height: 60px;
        width: 60px;
      }

      .card__button {
        width: 70px;
        padding: 0;
      }

      .card__button .btn {
        font-size: 1rem;
        height: 25px;
        padding: 8px;
      }
    }
  </style>
</head>



<body>

  <%- include('./partials/navbar') %>
  <section class="reports">
    <div class="card">
      <div class="card__header">
        <div class="card__profile">
          <img src="/images/uploads/<%=user.profileimage%>" alt="A man smiling" />
        </div>
        <div class="card__name">
          <h2><%=user.fullname%></h2>
          <div class="card__handle">
            <span class="handle" style="text-transform: lowercase;">@<%=user.username%></span>
          </div>
        </div>
        <div class="card__button">
          <a href="/editprofile" class="btn">Edit Profile</a>
          <a href="/logout" class="btn">Log out</a>
        </div>
      </div>
      <hr class="border" />
      <div class="card__insights">
        <div class="card__heading">
          <div class="heading">Reports</div>
        </div>
        <div class="insights">

          <% if (isAuthSuccess) { %>
          <% isAuthSuccess = false;%>
          <div class="customAlert" style="width: 100%;">
            <span class="alert-message" style="font-size: 1.5rem;">Resgistration <strong>successful</strong></span>
            <button class="close-btn" onclick="closeAlert()">Close</button>
          </div>
          <% } %>

          <% if (isDeleted) { %>
          <% isDeleted = false;%>
          <div class="customAlert" style="width: 100%;">
            <span class="alert-message" style="font-size: 1.5rem;">Report is now <strong>deleted!</strong></span>
            <button class="close-btn" onclick="closeAlert()">Close</button>
          </div>
          <% } %>

          <% if (isEdited) { %>
          <% isEdited = false;%>
          <div class="customAlert" style="width: 100%;">
            <span class="alert-message" style="font-size: 1.5rem;">Profile is<strong>updated!</strong></span>
            <button class="close-btn" onclick="closeAlert()">Close</button>
          </div>
          <% } %>


          <% if (user.reports.length > 0) { %>

          <% user.reports.forEach(report => { %>
          <div class="insight">
            <div class="heading">
              <% report.conditions.forEach((condition, index) => { %>
              <%= condition.condition %><% if (index < report.conditions.length - 1) { %> & <% } %>
              <% }) %>
              <a href="/deletereport/profile/<%= report._id %>"><i class="fa-solid fa-trash delete" id="btndelete"></i></a>
            </div>

            <div class="number">
              <div class="date"><%=report.date %></div>

              <div class="info">
                <a href="/report/<%= report._id %>">More Info</a>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
                  <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
              </div>
            </div>
          </div>
          <% }) %>
          <div style="text-align: center; display: flex; justify-content: center; align-items: center; width: 100%;">
            <a href="/allreports" class="btn">Display All</a>
          </div>

          <% } else { %>
          <h1 style="text-align: center; font-size: 2rem; width: 100%;">No Reports Availible</h1><br>
          <div style="text-align: center; display: flex; justify-content: center; align-items: center; width: 100%;">
            <a href="/test" class="btn">Add one</a>
          </div>
          <% } %>




        </div>
      </div>
    </div>

  </section>





  <%- include('partials/footer') %>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const menuBtn = document.getElementById("menu-btn");
      const navbar = document.querySelector(".navbar");

      menuBtn.addEventListener("click", function() {
        navbar.classList.toggle("active");
      });
    });

    function closeAlert() {
      var alert = document.querySelector('.customAlert');
      alert.style.display = 'none';


    }
  </script>

</body>

</html>